## AWS Glacier 与 AWS S3 Glacier存储类型

AWS Glacier: AWS Glacier 最初是作为独立服务推出的，而后来才以 **S3 Glacier 存储类型**（如 `GLACIER` 和 `DEEP_ARCHIVE`）
的形式集成到 S3 中。这种设计背后有几个关键原因，涉及技术架构、使用场景和市场策略：

### 1. **根本设计目标不同**
- **Glacier** 是专为**长期归档**设计的，核心目标是 **极低成本** 和 **超长存储周期**（比如几十年），但牺牲了实时访问能力（检索延迟从分钟到小时不等）。
- **S3** 的核心定位是**通用对象存储**，即使是最低频的 `S3 Standard-Infrequent Access (S3 IA)` 也要求毫秒级访问。
- 如果 Glacier 只是 S3 的一个存储类，早期技术架构上难以兼容（例如完全不同的存储后端和检索系统）。

### 2. **访问模式和 API 差异**
- **原生 Glacier** 使用独立的 API（如 `Initiate Job` 和 `Retrieve Archive`），操作围绕**归档库（Vault）**和**归档文件（Archive）**设计，需要显式发起检索任务并等待。
- **S3** 的 API 是统一的 `GET/PUT` 对象模型，后来通过 **S3 Glacier 存储类** 桥接了两种访问方式，但底层仍依赖 Glacier 的异步检索机制（如 `RestoreObject` 操作）。
*（早期用户需要直接调用 Glacier API，后来 AWS 通过 S3 生命周期策略和存储类简化了这一流程。）*

### 3. **计费模型和成本结构**
**Glacier** 的定价模型更复杂，涉及：
- **存储成本极低**（低于 S3 所有存储类）。
- **检索费用和延迟分级**（Expedited/Standard/Bulk 检索，费用递减但延迟递增）。
如果直接作为 S3 存储类，可能难以清晰区分这些成本（例如用户可能误以为 Glacier 数据可以免费实时读取）。

### 4. **数据恢复流程的差异**
- **原生 Glacier** 需要用户预先规划检索策略（例如“我需要 5 小时内取回数据，愿意支付更高费用”）。
- **S3 Glacier 存储类** 通过 `RestoreObject` 和生命周期规则抽象了这一过程，但本质上仍是异步操作（用户需等待数小时）。
  *（独立服务让 Glacier 可以更灵活地扩展功能，比如数据冻结策略（Vault Lock）或合规性选项。）*

### - 5. **历史演进与市场策略**
- **时间线**：Glacier 早在 2012 年就作为独立服务发布，而 S3 存储类（如 `GLACIER`）在 2016 年后才逐步引入。AWS 先通过独立服务验证需求，再逐步整合。
- **目标用户**：
  - 独立 Glacier 更适合**备份/归档软件厂商**（如 Commvault）或**企业合规团队**，他们需要直接控制归档流程。
  - S3 Glacier 存储类则吸引**已经使用 S3 的用户**，通过生命周期策略无缝过渡到低成本归档。

## 为什么后来又有 S3 Glacier 存储类？
AWS 意识到用户希望简化操作，因此通过 S3 存储类整合了 Glacier 的存储能力，但底层仍依赖 Glacier 服务。这种分层设计实现了：
- **统一管理**：用户通过 S3 API 和生命周期规则即可使用 Glacier。
- **灵活性**：高级用户仍可直接调用 Glacier API 实现更复杂需求（如 Vault Lock）。

## 总结
| **维度** | **AWS Glacier（独立服务）** | **S3 Glacier 存储类** |
|---|---|---|
| **设计目标** | 超低成本归档，独立流程 | S3 生态的一部分，简化归档 |
| **访问方式** | Glacier API（异步任务） | S3 API + `RestoreObject` |
| **适用场景** | 合规归档、备份软件集成 | S3 数据的自动分层 |
| **成本透明度** | 复杂检索费用模型 | 通过 S3 账单简化 |

Glacier 的独立性保留了其针对归档场景的深度优化，而 S3 存储类的整合降低了使用门槛。两者互补，覆盖不同用户需求。